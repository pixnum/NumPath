<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Numerology Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: #fff;
      padding: 20px;
      max-width: 700px;
      margin: auto;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
    }
    .results {
      margin-top: 30px;
      background-color: #1e1e1e;
      padding: 20px;
      border-radius: 8px;
    }
    .interpretation {
      margin-top: 10px;
      font-style: italic;
      font-size: 0.95em;
      color: #ddd;
    }
    .lo-shu-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 20px;
    }
    .lo-shu-cell {
      background-color: #2a2a2a;
      padding: 15px;
      text-align: center;
      border-radius: 5px;
      font-size: 1.2em;
    }
  </style>
</head>
<body>
  <h1>Numerology Calculator</h1>
  <input type="text" id="fullname" placeholder="Your Full Name">
  <input type="text" id="partnername" placeholder="Partner's Full Name (optional)">
  <input type="date" id="dob">
  <button onclick="calculateNumbers()">Calculate</button>
  <div class="results" id="results"></div>

  <script>
    const pythagoreanMap = {
      A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,
      J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,
      S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8
    };

    function reduceNumber(n) {
      while (![11, 22, 33].includes(n) && n > 9) {
        n = n.toString().split('').reduce((a,b)=>a+parseInt(b), 0);
      }
      return n;
    }

    function getNameValue(name, filterFn) {
      return name.toUpperCase().replace(/[^A-Z]/g, '').split('').filter(filterFn).reduce((sum, ch) => sum + (pythagoreanMap[ch] || 0), 0);
    }

    function getInterpretation(type, number) {
      const messages = {
        lifePath: {
          1: "You are a born leader..."
        },
        attitude: {
          1: "An assertive first impression..."
        },
        maturity: {
          1: "In maturity, you become a stronger leader..."
        },
        personalYear: {
          1: "This is a year of new beginnings..."
        },
        expression: {
          1: "Expression 1 indicates strong leadership skills and a pioneering spirit..."
        },
        soulUrge: {
          1: "Soul Urge 1 reveals a deep desire to be independent and original..."
        },
        personality: {
          1: "Personality 1 reflects a confident, assertive, and ambitious outer self..."
        },
        karmicLessons: {
          4: "You may have a karmic lesson with discipline and work ethic...",
          7: "A lesson in trust and spiritual connection may exist...",
          8: "You are learning balance in power, control, and finances..."
        },
        compatibility: {
          good: "Your name numbers are in harmony, indicating ease and support in your relationship.",
          average: "There may be challenges, but with effort, this relationship can thrive.",
          poor: "There are significant differences in your numerological energy. Clear communication is key."
        }
      };
      return messages[type] && messages[type][number] ? messages[type][number] : "";
    }

    function calculateLoShu(dob) {
      const digits = dob.replace(/-/g, '').split('');
      const grid = Array(10).fill(0);
      digits.forEach(d => grid[parseInt(d)]++);
      return grid;
    }

    function renderLoShu(grid) {
      const mapOrder = [3, 2, 1, 6, 5, 4, 9, 8, 7];
      return `
        <h3>Lo Shu Grid</h3>
        <div class="lo-shu-grid">
          ${mapOrder.map(n => `<div class="lo-shu-cell">${grid[n] || ''}</div>`).join('')}
        </div>
        <div class="interpretation">This grid shows how many times each number appears in your birth date. Empty cells may point to karmic lessons, while multiple digits suggest strengths. Analyze the balance to gain insight into your character and life path.</div>
      `;
    }

    function getKarmicLessons(dobDigits) {
      const missing = [1,2,3,4,5,6,7,8,9].filter(n => !dobDigits.includes(n.toString()));
      return missing;
    }

    function getCompatibilityScore(name1, name2) {
      const value1 = reduceNumber(getNameValue(name1, () => true));
      const value2 = reduceNumber(getNameValue(name2, () => true));
      const diff = Math.abs(value1 - value2);
      if (diff === 0 || diff === 1) return "good";
      if (diff <= 3) return "average";
      return "poor";
    }

    function calculateNumbers() {
      const fullName = document.getElementById("fullname").value.trim();
      const partnerName = document.getElementById("partnername").value.trim();
      const dob = document.getElementById("dob").value;
      if (!fullName || !dob) return alert("Please enter your name and date of birth.");

      const nameLetters = fullName.toUpperCase().replace(/[^A-Z]/g, '');
      const vowels = ['A', 'E', 'I', 'O', 'U'];

      const expressionNum = reduceNumber(getNameValue(fullName, () => true));
      const soulUrgeNum = reduceNumber(getNameValue(fullName, l => vowels.includes(l)));
      const personalityNum = reduceNumber(getNameValue(fullName, l => !vowels.includes(l)));

      const [year, month, day] = dob.split("-").map(n => parseInt(n));
      const birthdayNum = reduceNumber(day);
      const attitudeNum = reduceNumber(day + month);
      const lifePathNum = reduceNumber(year + month + day);
      const maturityNum = reduceNumber(expressionNum + lifePathNum);

      const currentYear = new Date().getFullYear();
      const personalYear = reduceNumber(currentYear + month + day);

      const results = document.getElementById("results");
      const dobDigits = dob.replace(/-/g, '').split('');
      const karmicLessons = getKarmicLessons(dobDigits);

      let compatibility = "";
      if (partnerName) {
        const score = getCompatibilityScore(fullName, partnerName);
        compatibility = `<p><strong>Compatibility:</strong> ${score}</p>
        <div class="interpretation">${getInterpretation("compatibility", score)}</div>`;
      }

      results.innerHTML = `
        <h3>Numerology Results</h3>

        <p><strong>Expression Number:</strong> ${expressionNum}</p>
        <div class="interpretation">${getInterpretation("expression", expressionNum)}</div>

        <p><strong>Soul Urge Number:</strong> ${soulUrgeNum}</p>
        <div class="interpretation">${getInterpretation("soulUrge", soulUrgeNum)}</div>

        <p><strong>Personality Number:</strong> ${personalityNum}</p>
        <div class="interpretation">${getInterpretation("personality", personalityNum)}</div>

        <p><strong>Life Path Number:</strong> ${lifePathNum}</p>
        <div class="interpretation">${getInterpretation("lifePath", lifePathNum)}</div>

        <p><strong>Attitude Number:</strong> ${attitudeNum}</p>
        <div class="interpretation">${getInterpretation("attitude", attitudeNum)}</div>

        <p><strong>Maturity Number:</strong> ${maturityNum}</p>
        <div class="interpretation">${getInterpretation("maturity", maturityNum)}</div>

        <p><strong>Personal Year Number:</strong> ${personalYear}</p>
        <div class="interpretation">${getInterpretation("personalYear", personalYear)}</div>

        ${renderLoShu(calculateLoShu(dob))}

        <p><strong>Karmic Lessons:</strong> ${karmicLessons.join(', ') || 'None'}</p>
        ${karmicLessons.map(n => `<div class="interpretation">${getInterpretation("karmicLessons", n)}</div>`).join('')}

        ${compatibility}
      `;
    }
  </script>
</body>
</html>
